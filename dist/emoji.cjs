"use strict";var c=Object.defineProperty;var r=(o,t,e)=>t in o?c(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e;var s=(o,t,e)=>r(o,typeof t!="symbol"?t+"":t,e);const a=require("@emoji-mart/data"),h=require("emoji-mart"),l=class l{constructor(t,e={}){s(this,"quill");s(this,"options");s(this,"picker");s(this,"isPickerVisible");this.quill=t,this.options={...l.DEFAULTS,...e},this.picker=null,this.isPickerVisible=!1,this.init()}init(){const t=this.quill.getModule("toolbar");if(t&&t.container){const e=document.createElement("button");e.className="ql-emoji",e.type="button",e.title="插入表情符号",t.container.appendChild(e),e.addEventListener("click",i=>{i.preventDefault(),i.stopPropagation(),this.isPickerVisible?this.closeDialog():(this.openDialog(),this.isPickerVisible=!0)})}}getButton(){return document.getElementsByClassName("ql-emoji")[0]}openDialog(){var t;if(!this.picker){this.picker=new h.Picker({data:a,onEmojiSelect:i=>this.selectEmoji(i),onClickOutside:i=>this.onClickOutside(i),...this.options}),document.body.appendChild(this.picker);const e=(t=this.getButton())==null?void 0:t.getBoundingClientRect();e&&(this.picker.style.top=`${e.top+25}px`,this.picker.style.left=`${e.left}px`),this.picker.style.boxShadow="0 4px 4px 0 rgba(0, 0, 0, 0.25)",this.picker.style.position="absolute",this.picker.style.zIndex="1"}}selectEmoji(t){const e=this.quill.insertText(this.quill.getSelection(!0).index,t.native,"user");this.closeDialog(),setTimeout(()=>{this.quill.setSelection(this.quill.getSelection(!0).index+e.length())})}onClickOutside(t){const e=this.getButton();(!e||!(e===t.target||t.target instanceof Element&&e.contains(t.target)))&&this.closeDialog()}closeDialog(){var t;this.isPickerVisible=!1,(t=this.picker)==null||t.remove(),this.picker=null}destroy(){this.closeDialog()}};s(l,"DEFAULTS",{theme:"light",locale:"zh",set:"native",skinTonePosition:"none",previewPosition:"bottom",searchPosition:"sticky",categories:["frequent","people","nature","foods","activity","places","objects","symbols","flags"],maxFrequentRows:2,perLine:8,navPosition:"top",noCountryFlags:!1,dynamicWidth:!1});let n=l;module.exports=n;
